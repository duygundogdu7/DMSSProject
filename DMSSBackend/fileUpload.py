import base64
import csv
import pandas as pd
from pymongo import MongoClient


client = MongoClient('localhost', 27017)
db = client['DMSS']
#data = "U3RhdHVzQ29kZSxTdGF0dXMsRHVydW0sS2ltZGVuLFlldGtpLELDtmxnZSxCw7ZsZ2VEZXRheSzEsGxhblRhcmloLFlhcMSxbMSxLEXFn3lhbMSxLEZpeWF0LFBhcmEsQsO2bMO8bSxtMizFnmlya2V0LExpbmssTm8sRGFuxLHFn21hbi9TYWhpcCxDZXBUZWwsRGnEn2VyVGVsLEthdFNhecSxc8SxLEJ1bC5LYXQsQWlkYXQsU2l0ZSxIZWFkZXIKMjAwLE9LLEtpcmFsxLFrIETDvGtrYW4gJiBNYcSfYXphLEVtbGFrw6fEsWRhbixZb2ssQmFsZ2F0LCw0Mjg5OCwsLDM1MDAsVEwsMSwxNjAsVVNUQSBFTUxBSyBNw5zFnkFWxLBSTMSwxJ7EsC01NTU0LGh0dHA6Ly93d3cuaHVycml5ZXRlbWxhay5jb20vaXN5ZXJpLWtpcmFsaWsvYW5rYXJhLWNhbmtheWEtYmFsZ2F0LWVtbGFrY2lkYW4tZHVra2FuLW1hZ2F6YS9kZXRheS8yNTgxNDg2OCwyNTgxNDg2OCxNdXN0YWZhIFnDvEtTRUwsKDU1NSkgNDQxIDAwIDExLCgzMTIpIDI4NiA1NiA3NiwsLCwsWUlMRElSSU0gS1VMRSBLQVLFnklTSSBLxLBSQUxJSyBEw5xLS0FOCjIwMCxPSyxTYXTEsWzEsWsgT2ZpcyxFbWxha8OnxLFkYW4sWW9rLEJhbGdhdCwsNDI4OTgsLCw4MjUwMDAsVEwsMTAsMTgwLMOHw5ZMT8SeTFUgR0FZUsSwTUVOS1VMLTM0OTMsaHR0cDovL3d3dy5odXJyaXlldGVtbGFrLmNvbS9pc3llcmktc2F0aWxpay9hbmthcmEtY2Fua2F5YS1iYWxnYXQtZW1sYWtjaWRhbi1vZmlzL2RldGF5LzI2NDMzNjg4LDI2NDMzNjg4LEtPUkFZIMOHw5ZMT8SeTFUsKDUzMikgNzAzIDA1IDI1LCgzMTIpIDQ4MSA4OCA2Nyw1LCwsLMOHw5ZMT8SeTFVOREFOIEtPTllBIFlPTFUgR8OWS0tVxZ5BxJ5JTkRBIDcrU0VLUkVURVIgU8OcUEVSIEzDnFhYWCBPRsSwUwoyMDAsT0ssU2F0xLFsxLFrIETDvGtrYW4gJiBNYcSfYXphLEVtbGFrw6fEsWRhbixWYXIsQmFsZ2F0LCw0Mjg5OCxFdmV0LCwxNzUwMDAwLFRMLDMsMjQwLERPxJ5BTiBFTUxBSy9TxLBOQU4gQ0FEREVTxLAtMjEyMixodHRwOi8vd3d3Lmh1cnJpeWV0ZW1sYWsuY29tL2lzeWVyaS1zYXRpbGlrL2Fua2FyYS1jYW5rYXlhLWJhbGdhdC1lbWxha2NpZGFuLWR1a2thbi1tYWdhemEvZGV0YXkvMjY0MzI5NDMsMjY0MzI5NDMsRXJlbiBLQURJWU9SQU4sKDUzOSkgODE4IDc1IDYzLCgzMTIpIDQ4MCA4MCA0NywzLCwsLERPxJ5BTiAzJ0RFTiBDQURERSDDnFpFUsSwIEtVUlVNU0FMIEvEsFJBQ0lMSQoyMDAsT0ssU2F0xLFsxLFrIETDvGtrYW4gJiBNYcSfYXphLEVtbGFrw6fEsWRhbixWYXIsQmFsZ2F0LCw0Mjg5OCwsLDk5MDAwMCxUTCw5LDUwMCxET8SeQU4gRU1MQUsvU8SwTkFOIENBRERFU8SwLTIxMjIsaHR0cDovL3d3dy5odXJyaXlldGVtbGFrLmNvbS9pc3llcmktc2F0aWxpay9hbmthcmEtY2Fua2F5YS1iYWxnYXQtZW1sYWtjaWRhbi1kdWtrYW4tbWFnYXphL2RldGF5LzI2NDMzNDI1LDI2NDMzNDI1LEVyZW4gS0FESVlPUkFOLCg1MzkpIDgxOCA3NSA2MywoMzEyKSA0ODAgODAgNDcsNSwsLCxET8SeQU4gMydERU4gRU1TQUxTxLBaIDUwME0yIEzDnFggRMOcS0tBTi1PRsSwUwoyMDAsT0ssS2lyYWzEsWsgRMO8a2thbiAmIE1hxJ9hemEsRW1sYWvDp8SxZGFuLFZhcixCYWxnYXQsLDQyODk4LEV2ZXQsLDMyNTAsVEwsOCwxNjAsRE/EnkFOIEVNTEFLL1PEsE5BTiBDQURERVPEsC0yMTIyLGh0dHA6Ly93d3cuaHVycml5ZXRlbWxhay5jb20vaXN5ZXJpLWtpcmFsaWsvYW5rYXJhLWNhbmtheWEtYmFsZ2F0LWVtbGFrY2lkYW4tZHVra2FuLW1hZ2F6YS9kZXRheS8yNjQzNTA5NCwyNjQzNTA5NCxFcmVuIEtBRElZT1JBTiwoNTM5KSA4MTggNzUgNjMsKDMxMikgNDgwIDgwIDQ3LDMsLCwsRE/EnkFOIDMgREVOIDUrIFNFS1JFVEVSWUEgU8OcUEVSIEzDnFggWUFQSUxJIFdDIE1VVEZBSwoyMDAsT0ssS2lyYWzEsWsgT2ZpcyxFbWxha8OnxLFkYW4sWW9rLEJhbGdhdCwsNDI4OTgsLCw0NzUwLFRMLDYsMzAwLFBSRVNUxLBKIEdBWVLEsE1FTktVTC0xNDY1LGh0dHA6Ly93d3cuaHVycml5ZXRlbWxhay5jb20vaXN5ZXJpLWtpcmFsaWsvYW5rYXJhLWNhbmtheWEtYmFsZ2F0LWVtbGFrY2lkYW4tb2Zpcy9kZXRheS8yNjQzNjMxNCwyNjQzNjMxNCxFQlJVIEfDvE5FTCwoNTMyKSA3MDcgMzMgMTUsKDMxMikgNDcyIDg0IDE0LDMsLCwsUFJFU1TEsEonREVOIMSwxZ4gTUVSS0VaxLBOREUgMzAwIE0yIEFSQSBLQVQgQ0FEREUgw5xaRVLEsCBPRsSwUwoyMDAsT0ssS2lyYWzEsWsgRMO8a2thbiAmIE1hxJ9hemEsRW1sYWvDp8SxZGFuLFlvayxCYWxnYXQsLDQyODk4LCwsMzUwMCxUTCwyLDIyMCxLVUxFTMSwIEdBWVLEsE1FTktVTC0yNjg3NSxodHRwOi8vd3d3Lmh1cnJpeWV0ZW1sYWsuY29tL2lzeWVyaS1raXJhbGlrL2Fua2FyYS1jYW5rYXlhLWJhbGdhdC1lbWxha2NpZGFuLWR1a2thbi1tYWdhemEvZGV0YXkvMjY0MzU0ODMsMjY0MzU0ODMsU2VycGlsIMOWemRvxJ9hbiwoNTMyKSAzODQgMTEgMzAsKDMxMikgNDQ2IDA0IDA2LCwsLCxCQUxHQVQnVEEgREVWUkVOIFlPTEEgQ0VQSEVMxLAgTUFSS0VUCjIwMCxPSyxTYXTEsWzEsWsgUGxhemEgS2F0xLEsRW1sYWvDp8SxZGFuLFlvayxCYWxnYXQsLDQyODk4LCwsOTc1MDAwLFRMLDUsMjUwLMWeRUjEsFIgRU1MQUstNTE0NixodHRwOi8vd3d3Lmh1cnJpeWV0ZW1sYWsuY29tL2lzeWVyaS1zYXRpbGlrL2Fua2FyYS1jYW5rYXlhLWJhbGdhdC1lbWxha2NpZGFuLXBsYXphLWthdGkvZGV0YXkvMjI2MzU5OTksMjI2MzU5OTksRMSwTEVLIFPDvE1FTiwsKDMxMikgNDI3IDE0IDI4LDMsLCwsxZ5FSMSwUiBCQUxHQVRUQSBTSUZJUiAzIEFSQcOHIE9UT1BBUktMSSBEVUJMRUtTIFNBVElZT1IKMjAwLE9LLEtpcmFsxLFrIEFwYXJ0bWFuIERhaXJlc2ksRW1sYWvDp8SxZGFuLFlvayxCYWxnYXQsLDQyODk4LCwsMjUwMCxUTCwzLDM1MCxHw5xSU0VMIEVNTEFLLTE5MDM3LGh0dHA6Ly93d3cuaHVycml5ZXRlbWxhay5jb20vaXN5ZXJpLWtpcmFsaWsvYW5rYXJhLWNhbmtheWEtYmFsZ2F0LWVtbGFrY2lkYW4tYXBhcnRtYW4tZGFpcmVzaS9kZXRheS8yMzgyODE5MywyMzgyODE5MyxHw7xyc2VsIMOHQcSeSVIsKDUzMikgNDgyIDAyIDEyLCgzMTIpIDQ3OSAwNSA3MCw0LCwsLEJBTEdBVCBHw5ZLS1XFnkHEnkkgQ0FEREVTxLBOREUgMzUwIE0yIEhFUsSwxZ5FIFVZR1VO"
#data = 'Zm9vLGJhcixiYXoKYWFhLGJiYixjY2MKZGRkLGVlZSxmZmYKMDAwLDExMSwwMDA='
data = 'U3RhdHVzIENvZGUJU3RhdHVzCUR1cnVtCUtpbWRlbglZZXRraQlCw7ZsZ2UJQsO2bGdlIERldGF5CcSwbGFuIFRhcmloCVlhcMSxbMSxCUXFn3lhbMSxCSBGaXlhdCAJUGFyYQlCw7Zsw7xtCW0yCcWeaXJrZXQJTGluawlObwlEYW7EscWfbWFuL1NhaGlwCUNlcCBUZWwJRGnEn2VyIFRlbAlLYXQgU2F5xLFzxLEJQnVsLiBLYXQJQWlkYXQJU2l0ZQlIZWFkZXINCjIwMwlPSwlTYXTEsWzEsWsgUmVzaWRlbmNlCVNhaGliaW5kZW4JCUFua2FyYSAvIMOHYW5rYXlhIC8gw4dheXlvbHUJCTEwLjYuMjAxNwkJCSAyNDUuMDAwIAlUTAkxICsgMAkzMAkJaHR0cDovL3d3dy5odXJyaXlldGVtbGFrLmNvbS9rb251dC1zYXRpbGlrL2Fua2FyYS1jYW5rYXlhLWNheXlvbHUtc2FoaWJpbmRlbi1yZXNpZGVuY2UvZGV0YXkvMjY0MTg1ODcJMjY0MTg1ODcJaMO8c2V5aW4gaGF0aXBvxJ9sdQkoNTU1KSA1NjYgNTYgODkJCQkxMgkJV2VzdCBHYXRlIFJlc2lkZW5jZQlTQUhJQklOREVOIFdFU1QgR0FURSdURSAxKzAgSEnDhyBPVFVSVUxNQU3EscWeIFJFWklEQU5TDQoyMDMJT0sJU2F0xLFsxLFrIEFwYXJ0bWFuIERhaXJlc2kJRW1sYWvDp8SxZGFuCVZhcglBbmthcmEgLyDDh2Fua2F5YSAvIFlhxZ9hbWtlbnQJCTkuNi4yMDE3CQkJIDMzNS4wMDAgCVRMCTEgKyAxCTcwCURFTsSwWiBFTUxBSyBZYcWfYW1rZW50LTY4OTAJaHR0cDovL3d3dy5odXJyaXlldGVtbGFrLmNvbS9rb251dC1zYXRpbGlrL2Fua2FyYS1jYW5rYXlhLXlhc2Fta2VudC1lbWxha2NpZGFuLWFwYXJ0bWFuLWRhaXJlc2kvZGV0YXkvMjY0MDc4NzYJMjY0MDc4NzYJQXlzZWwgQ0FORVIJKDUzMikgMjQyIDM2IDkwCSgzMTIpIDIxNyAwMCA3NwkzMgkxNQkyNjQgVEwJV2VzdCBHYXRlIFJlc2lkZW5jZQlXRVNUIEdBVEUgQU5LQVJBTklOIEVOIEfDllpERSBSRVPEsERFTkNFIFZFIEFWTSBQUk9KRUxFUsSwTkRFTiBCxLBSxLANCjIwMwlPSwlTYXTEsWzEsWsgQXBhcnRtYW4gRGFpcmVzaQlFbWxha8OnxLFkYW4JVmFyCUFua2FyYSAvIMOHYW5rYXlhIC8gWWHFn2Fta2VudAkJOS42LjIwMTcJCQkgMzk1LjAwMCAJVEwJMSArIDEJNzEJREVOxLBaIEVNTEFLIFlhxZ9hbWtlbnQtNjg5MAlodHRwOi8vd3d3Lmh1cnJpeWV0ZW1sYWsuY29tL2tvbnV0LXNhdGlsaWsvYW5rYXJhLWNhbmtheWEteWFzYW1rZW50LWVtbGFrY2lkYW4tYXBhcnRtYW4tZGFpcmVzaS9kZXRheS8yNjQwODAyOQkyNjQwODAyOQlBeXNlbCBDQU5FUgkoNTMyKSAyNDIgMzYgOTAJKDMxMikgMjE3IDAwIDc3CTMyCTIwCTI2NCBUTAlXZXN0IEdhdGUgUmVzaWRlbmNlCURFTsSwWidERU4gV0VTVEdBVEUnREUgMSsxIEdFTsSwxZ4gTVVURkFLTEkgTMOcWCBEQcSwUkUNCjIwMwlPSwlTYXTEsWzEsWsgQXBhcnRtYW4gRGFpcmVzaQlFbWxha8OnxLFkYW4JVmFyCUFua2FyYSAvIMOHYW5rYXlhIC8gWWHFn2Fta2VudAkJOS42LjIwMTcJCQkgNjM1LjAwMCAJVEwJMiArIDEJMTM3CURFTsSwWiBFTUxBSyBZYcWfYW1rZW50LTY4OTAJaHR0cDovL3d3dy5odXJyaXlldGVtbGFrLmNvbS9rb251dC1zYXRpbGlrL2Fua2FyYS1jYW5rYXlhLXlhc2Fta2VudC1lbWxha2NpZGFuLWFwYXJ0bWFuLWRhaXJlc2kvZGV0YXkvMjY0MDgxMDEJMjY0MDgxMDEJQXlzZWwgQ0FORVIJKDUzMikgMjQyIDM2IDkwCSgzMTIpIDIxNyAwMCA3NwkzMgk1CQlXZXN0IEdhdGUgUmVzaWRlbmNlCURFTsSwWidERU4gV0VTVEdBVEUnREUgMisxIEfDnE5FWSBCQVRJIENFUEhFIFRFUkFTTEkgTMOcWCBEQcSwUkUNCjIwMwlPSwlTYXTEsWzEsWsgQXBhcnRtYW4gRGFpcmVzaQlFbWxha8OnxLFkYW4JVmFyCUFua2FyYSAvIMOHYW5rYXlhIC8gWWHFn2Fta2VudAkJOS42LjIwMTcJCQkgMzc1LjAwMCAJVEwJMSArIDEJNTQJREVOxLBaIEVNTEFLIFlhxZ9hbWtlbnQtNjg5MAlodHRwOi8vd3d3Lmh1cnJpeWV0ZW1sYWsuY29tL2tvbnV0LXNhdGlsaWsvYW5rYXJhLWNhbmtheWEteWFzYW1rZW50LWVtbGFrY2lkYW4tYXBhcnRtYW4tZGFpcmVzaS9kZXRheS8yNjQwODE2MQkyNjQwODE2MQlBeXNlbCBDQU5FUgkoNTMyKSAyNDIgMzYgOTAJKDMxMikgMjE3IDAwIDc3CTMyCTUJMjgyIFRMCVdlc3QgR2F0ZSBSZXNpZGVuY2UJREVOxLBaJ0RFTiBXRVNUIEdBVEUnREUgMSsxIEdFTsSwxZ4gVEVaR0FITEkgRVNLxLDFnkVIxLBSIFlPTFUgQ0VQSEVMxLANCg=='
text =  base64.b64decode(data).decode('UTF-8')
f = open("temp_file.csv", "w")
f.write(text)
f.close()
df = pd.read_csv("temp_file.csv") 
print(df.nunique())
'''
df = df.drop(['Bul. Kat'], axis=1)
records_ = df.to_dict(orient = 'records')
db.Emp.insert_many(records_ )
'''